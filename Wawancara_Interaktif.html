<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wawancara Interaktif Kelas 4 - Rekaman Suara & STT</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #11998e;
            --warning: #f093fb;
            --danger: #fc466b;
            --info: #4facfe;
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .logo-container {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        h1 {
            font-size: 2.5rem;
            color: var(--text-primary);
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--bg-secondary);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.5rem;
        }

        .card-title {
            font-size: 1.5rem;
            color: var(--text-primary);
        }

        .card-content {
            flex-grow: 1;
            margin-bottom: 20px;
        }

        .card-footer {
            display: flex;
            justify-content: flex-end;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #38ef7d);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #f5576c);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #fc466b);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, var(--info), #00f2fe);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            padding: 20px;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 25px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .interview-container {
            padding: 30px;
        }

        .interview-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .interview-title {
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .interview-subject {
            font-size: 1.3rem;
            color: var(--primary);
            font-weight: 600;
        }

        .question-container {
            margin-bottom: 30px;
        }

        .question {
            font-size: 1.2rem;
            margin-bottom: 15px;
            padding: 15px;
            background: #f1f3f4;
            border-radius: 15px;
            border-left: 5px solid var(--primary);
        }

        .answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .interview-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .interview-navigation {
            display: flex;
            gap: 10px;
        }

        .progress-bar {
            height: 8px;
            background: #f1f3f4;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            transition: width 0.5s;
        }

        .interview-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #718096;
        }

        .dynamic-island {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 0.9rem;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .dynamic-island.active {
            opacity: 1;
        }

        /* Voice Recording Styles */
        .voice-recording-container {
            margin-bottom: 20px;
            padding: 15px;
            background: #f1f3f4;
            border-radius: 15px;
            border: 2px dashed var(--primary);
        }

        .voice-recording-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .voice-recording-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.2rem;
        }

        .voice-recording-title {
            font-size: 1.2rem;
            color: var(--text-primary);
        }

        .voice-recording-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .voice-recording-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .voice-recording-btn i {
            margin-right: 8px;
        }

        .voice-recording-btn.record {
            background: linear-gradient(135deg, var(--danger), #fc466b);
            color: white;
        }

        .voice-recording-btn.stop {
            background: linear-gradient(135deg, var(--warning), #f5576c);
            color: white;
        }

        .voice-recording-btn.transcribe {
            background: linear-gradient(135deg, var(--success), #38ef7d);
            color: white;
        }

        .voice-recording-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .voice-recording-status {
            text-align: center;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .voice-recording-visualizer {
            height: 60px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .voice-recording-wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, var(--primary), var(--secondary));
            opacity: 0.7;
            transform-origin: bottom;
        }

        .voice-recording-timer {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .transcription-result {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            min-height: 80px;
            max-height: 200px;
            overflow-y: auto;
        }

        .transcription-accuracy {
            text-align: center;
            font-size: 0.8rem;
            color: var(--success);
            margin-top: 5px;
            font-weight: bold;
        }

        /* Results Styles */
        .results-container {
            text-align: center;
            padding: 30px;
        }

        .results-title {
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f1f3f4;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: #718096;
        }

        .answers-review {
            text-align: left;
            margin-bottom: 30px;
        }

        .answer-item {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 15px;
            background: #f1f3f4;
        }

        .answer-question {
            font-weight: 600;
            margin-bottom: 10px;
        }

        /* Children Report Styles */
        .children-report {
            background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 8px solid #ff6b6b;
            font-family: 'Comic Sans MS', cursive;
        }

        .children-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .children-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .children-subtitle {
            font-size: 1.3rem;
            color: #666;
        }

        .animal-characters {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .animal {
            font-size: 3rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .sticker {
            position: absolute;
            width: 80px;
            height: 80px;
            background: #ffd93d;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            transform: rotate(-15deg);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border: 3px solid #ff6b6b;
        }

        .sticker-1 { top: -20px; left: -20px; }
        .sticker-2 { top: -20px; right: -20px; background: #6bcf7f; }
        .sticker-3 { bottom: -20px; left: -20px; background: #4d96ff; }
        .sticker-4 { bottom: -20px; right: -20px; background: #ff6b9d; }

        .certificate {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 30px;
            border-radius: 25px;
            text-align: center;
            border: 5px solid #ff6b6b;
            margin-top: 30px;
        }

        .certificate-title {
            font-size: 2rem;
            color: #ff6b6b;
            margin-bottom: 15px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .app-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .interview-controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .interview-navigation {
                justify-content: center;
            }
            
            .voice-recording-controls {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="dynamic-island" id="dynamicIsland"></div>

    <div class="container">
        <header>
            <div class="logo-container">
                <i class="fas fa-microphone-alt"></i>
            </div>
            <h1>Wawancara Interaktif Kelas 4</h1>
            <p class="subtitle">Aplikasi wawancara dengan fitur rekaman suara dan transkripsi otomatis</p>
        </header>

        <div class="app-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <h2 class="card-title">Wawancara Siswa</h2>
                </div>
                <div class="card-content">
                    <p>Wawancara dengan siswa kelas 4 tentang pengalaman belajar, hobi, dan kehidupan sekolah sehari-hari.</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary" onclick="startInterview('siswa')">
                        <i class="fas fa-play"></i> Mulai Wawancara
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <h2 class="card-title">Wawancara Guru</h2>
                </div>
                <div class="card-content">
                    <p>Wawancara dengan guru kelas 4 tentang metode mengajar, tantangan, dan pengalaman mengajar.</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary" onclick="startInterview('guru')">
                        <i class="fas fa-play"></i> Mulai Wawancara
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <h2 class="card-title">Wawancara Kepala Sekolah</h2>
                </div>
                <div class="card-content">
                    <p>Wawancara dengan kepala sekolah tentang visi, misi, dan pengelolaan sekolah secara keseluruhan.</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary" onclick="startInterview('kepala_sekolah')">
                        <i class="fas fa-play"></i> Mulai Wawancara
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-user-cog"></i>
                    </div>
                    <h2 class="card-title">Wawancara Staf Tata Usaha</h2>
                </div>
                <div class="card-content">
                    <p>Wawancara dengan staf tata usaha tentang administrasi sekolah dan dukungan operasional.</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary" onclick="startInterview('staf_tu')">
                        <i class="fas fa-play"></i> Mulai Wawancara
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h2 class="card-title">Wawancara Petugas Kantin</h2>
                </div>
                <div class="card-content">
                    <p>Wawancara dengan petugas kantin tentang makanan sehat, kebersihan, dan pengalaman melayani siswa.</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary" onclick="startInterview('petugas_kantin')">
                        <i class="fas fa-play"></i> Mulai Wawancara
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <h2 class="card-title">Informasi Developer</h2>
                </div>
                <div class="card-content">
                    <p>Informasi tentang developer aplikasi ini dan fitur-fitur yang tersedia.</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-info" onclick="showDeveloperInfo()">
                        <i class="fas fa-user"></i> Lihat Info
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal untuk wawancara -->
    <div class="modal" id="interviewModal">
        <div class="modal-content">
            <div class="interview-container" id="interviewContent">
                <!-- Konten wawancara akan dimuat di sini -->
            </div>
        </div>
    </div>

    <!-- Modal untuk hasil wawancara -->
    <div class="modal" id="resultsModal">
        <div class="modal-content">
            <div class="results-container" id="resultsContent">
                <!-- Konten hasil wawancara akan dimuat di sini -->
            </div>
        </div>
    </div>

    <!-- Modal untuk developer info -->
    <div class="modal" id="developerModal">
        <div class="modal-content">
            <div class="interview-container" id="developerContent">
                <!-- Konten developer info akan dimuat di sini -->
            </div>
        </div>
    </div>

    <script>
        // Data untuk aplikasi
        const InterviewApp = {
            currentSubject: null,
            currentQuestionIndex: 0,
            answers: [],
            collectedAnswers: [],
            questions: {},
            stats: {
                interviewsCompleted: 0,
                totalQuestions: 0,
                correctAnswers: 0
            },
            sessionStart: Date.now(),
            // Data untuk rekaman suara
            voiceRecording: {
                isRecording: false,
                mediaRecorder: null,
                audioChunks: [],
                audioBlob: null,
                audioUrl: null,
                recordingTimer: null,
                recordingStartTime: null,
                recordingDuration: 0,
                transcription: "",
                transcriptionAccuracy: 0,
                recognition: null,
                isSpeechRecognitionSupported: false
            }
        };

        // Data pertanyaan untuk setiap subjek
        const interviewQuestions = {
            siswa: [
                "Siapa nama lengkap kamu?",
                "Apa kelas dan sekolah kamu?",
                "Apa mata pelajaran favorit kamu? Mengapa?",
                "Apa hobi atau kegiatan yang paling kamu sukai di luar sekolah?",
                "Siapa teman terdekat kamu di sekolah? Ceritakan sedikit tentang dia.",
                "Apa cita-cita kamu ketika besar nanti?",
                "Bagaimana perasaan kamu tentang sekolah?",
                "Apa kegiatan sekolah yang paling menyenangkan menurut kamu?",
                "Jika kamu bisa mengubah satu hal di sekolah, apa yang akan kamu ubah?",
                "Apa pelajaran yang paling menantang bagi kamu? Bagaimana kamu mengatasinya?"
            ],
            guru: [
                "Bisa Anda perkenalkan diri? (Nama, mata pelajaran yang diampu, pengalaman mengajar)",
                "Apa yang membuat Anda memilih menjadi guru?",
                "Bagaimana pendekatan Anda dalam mengajar siswa kelas 4?",
                "Apa tantangan terbesar dalam mengajar siswa kelas 4?",
                "Bagaimana Anda memotivasi siswa yang kurang bersemangat dalam belajar?",
                "Apa perubahan paling signifikan yang Anda lihat dalam pendidikan selama karir Anda?",
                "Bagaimana Anda menangani perbedaan kemampuan belajar di antara siswa?",
                "Apa metode penilaian yang Anda gunakan untuk mengevaluasi siswa?",
                "Bagaimana Anda melibatkan orang tua dalam proses pendidikan?",
                "Apa saran Anda untuk orang tua dalam mendukung pendidikan anak mereka?"
            ],
            kepala_sekolah: [
                "Bisa Anda perkenalkan diri dan peran Anda sebagai kepala sekolah?",
                "Apa visi dan misi sekolah yang Anda pimpin?",
                "Bagaimana strategi Anda dalam meningkatkan kualitas pendidikan di sekolah?",
                "Apa program unggulan yang sedang dijalankan di sekolah ini?",
                "Bagaimana Anda menangani tantangan dalam manajemen sekolah?",
                "Bagaimana hubungan antara sekolah dengan komunitas sekitar?",
                "Apa kebijakan Anda dalam menangani siswa dengan kebutuhan khusus?",
                "Bagaimana Anda memastikan kualitas pengajaran guru-guru di sekolah?",
                "Apa pencapaian terbesar sekolah selama kepemimpinan Anda?",
                "Bagaimana Anda melihat masa depan pendidikan dan peran sekolah dalam beberapa tahun ke depan?"
            ],
            staf_tu: [
                "Bisa Anda perkenalkan diri dan peran Anda di sekolah?",
                "Apa tugas utama Anda sebagai staf tata usaha?",
                "Bagaimana Anda mengelola administrasi sekolah sehari-hari?",
                "Apa tantangan terbesar dalam pekerjaan Anda?",
                "Bagaimana sistem pengarsipan dokumen di sekolah?",
                "Bagaimana Anda berkoordinasi dengan guru dan kepala sekolah?",
                "Apa yang paling Anda sukai dari pekerjaan Anda?",
                "Bagaimana Anda menangani orang tua atau tamu yang datang ke sekolah?",
                "Apa perubahan dalam sistem administrasi sekolah yang Anda lihat dalam beberapa tahun terakhir?",
                "Apa saran Anda untuk meningkatkan efisiensi administrasi sekolah?"
            ],
            petugas_kantin: [
                "Bisa Anda perkenalkan diri dan peran Anda di kantin sekolah?",
                "Berapa lama Anda sudah bekerja di kantin sekolah ini?",
                "Apa menu favorit siswa di kantin?",
                "Bagaimana Anda memastikan kebersihan dan keamanan makanan?",
                "Dari mana bahan makanan untuk kantin diperoleh?",
                "Bagaimana Anda menentukan harga jual makanan di kantin?",
                "Apa tantangan terbesar dalam mengelola kantin sekolah?",
                "Bagaimana Anda menangani siswa yang tidak membawa uang untuk jajan?",
                "Apa yang paling Anda sukai dari pekerjaan Anda?",
                "Apa saran Anda untuk orang tua tentang makanan sehat untuk anak?"
            ]
        };

        // Fungsi untuk menampilkan notifikasi di dynamic island
        function updateDynamicIsland(message, duration = 3000) {
            const island = document.getElementById('dynamicIsland');
            island.textContent = message;
            island.classList.add('active');
            
            setTimeout(() => {
                island.classList.remove('active');
            }, duration);
        }

        // Fungsi untuk memulai wawancara
        function startInterview(subject) {
            InterviewApp.currentSubject = subject;
            InterviewApp.currentQuestionIndex = 0;
            InterviewApp.answers = [];
            InterviewApp.collectedAnswers = [];
            
            // Set judul berdasarkan subjek
            let subjectTitle = '';
            switch(subject) {
                case 'siswa':
                    subjectTitle = 'Siswa Kelas 4';
                    break;
                case 'guru':
                    subjectTitle = 'Guru Kelas 4';
                    break;
                case 'kepala_sekolah':
                    subjectTitle = 'Kepala Sekolah';
                    break;
                case 'staf_tu':
                    subjectTitle = 'Staf Tata Usaha';
                    break;
                case 'petugas_kantin':
                    subjectTitle = 'Petugas Kantin';
                    break;
            }
            
            const modal = document.getElementById('interviewModal');
            const content = document.getElementById('interviewContent');
            
            content.innerHTML = `
                <div class="interview-header">
                    <h2 class="interview-title">Wawancara Interaktif</h2>
                    <p class="interview-subject">Subjek: ${subjectTitle}</p>
                </div>
                
                <div class="progress-bar">
                    <div class="progress" id="interviewProgress" style="width: 0%"></div>
                </div>
                
                <div class="interview-stats">
                    <span>Pertanyaan: <span id="currentQuestion">1</span> / ${interviewQuestions[subject].length}</span>
                    <span id="interviewTime">Waktu: 0:00</span>
                </div>
                
                <div class="question-container">
                    <div class="question" id="currentQuestionText">${interviewQuestions[subject][0]}</div>
                    
                    <!-- Kontainer untuk rekaman suara -->
                    <div class="voice-recording-container">
                        <div class="voice-recording-header">
                            <div class="voice-recording-icon">
                                <i class="fas fa-microphone"></i>
                            </div>
                            <h3 class="voice-recording-title">Rekam Jawaban dengan Suara</h3>
                        </div>
                        
                        <div class="voice-recording-status" id="voiceRecordingStatus">
                            Tekan tombol rekam untuk mulai merekam jawaban
                        </div>
                        
                        <div class="voice-recording-timer" id="voiceRecordingTimer" style="display: none;">
                            00:00
                        </div>
                        
                        <div class="voice-recording-visualizer" id="voiceRecordingVisualizer" style="display: none;">
                            <div class="voice-recording-wave" id="voiceRecordingWave"></div>
                        </div>
                        
                        <div class="voice-recording-controls">
                            <button class="voice-recording-btn record" id="startRecordingBtn">
                                <i class="fas fa-microphone"></i> Mulai Rekam
                            </button>
                            <button class="voice-recording-btn stop" id="stopRecordingBtn" disabled>
                                <i class="fas fa-stop"></i> Stop Rekam
                            </button>
                            <button class="voice-recording-btn transcribe" id="transcribeBtn" disabled>
                                <i class="fas fa-language"></i> Transkrip Otomatis
                            </button>
                            <button class="voice-recording-btn" id="speechToTextBtn" style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white;">
                                <i class="fas fa-comment-dots"></i> Speech-to-Text
                            </button>
                        </div>
                        
                        <div class="transcription-result" id="transcriptionResult" style="display: none;">
                            <div id="transcriptionText"></div>
                            <div class="transcription-accuracy" id="transcriptionAccuracy"></div>
                        </div>
                    </div>
                    
                    <textarea class="answer-input" id="answerInput" placeholder="Tulis jawaban Anda di sini atau gunakan rekaman suara di atas..."></textarea>
                </div>
                
                <div class="interview-controls">
                    <div class="interview-navigation">
                        <button class="btn btn-danger" id="cancelInterviewBtn">
                            <i class="fas fa-times"></i> Batalkan
                        </button>
                    </div>
                    <div class="interview-navigation">
                        <button class="btn btn-info" id="prevQuestionBtn" ${InterviewApp.currentQuestionIndex === 0 ? 'disabled' : ''}>
                            <i class="fas fa-arrow-left"></i> Sebelumnya
                        </button>
                        <button class="btn btn-warning" id="collectAnswerBtn">
                            <i class="fas fa-save"></i> Kumpulkan Jawaban
                        </button>
                        <button class="btn btn-success" id="nextQuestionBtn" disabled>
                            ${InterviewApp.currentQuestionIndex === interviewQuestions[subject].length - 1 ? 
                                '<i class="fas fa-flag-checkered"></i> Selesai' : 
                                '<i class="fas fa-arrow-right"></i> Lanjut'}
                        </button>
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
            
            // Update progress bar
            updateProgressBar();
            
            // Mulai timer
            startInterviewTimer();
            
            // Inisialisasi event listeners untuk rekaman suara
            initVoiceRecording();
            
            // Event listeners
            document.getElementById('cancelInterviewBtn').addEventListener('click', cancelInterview);
            document.getElementById('prevQuestionBtn').addEventListener('click', prevQuestion);
            document.getElementById('nextQuestionBtn').addEventListener('click', nextQuestion);
            document.getElementById('collectAnswerBtn').addEventListener('click', collectAnswer);
            
            // Inisialisasi speech recognition
            initSpeechRecognition();
            
            updateDynamicIsland('📝 Wawancara Dimulai', 2000);
        }

        // Fungsi untuk mengumpulkan jawaban
        function collectAnswer() {
            const answerInput = document.getElementById('answerInput');
            const answer = answerInput.value.trim();
            
            if (!answer) {
                updateDynamicIsland('❌ Jawaban tidak boleh kosong', 2000);
                return;
            }
            
            // Simpan jawaban yang dikumpulkan
            InterviewApp.collectedAnswers[InterviewApp.currentQuestionIndex] = answer;
            
            // Nonaktifkan input dan tombol rekaman
            answerInput.disabled = true;
            document.getElementById('startRecordingBtn').disabled = true;
            document.getElementById('stopRecordingBtn').disabled = true;
            document.getElementById('transcribeBtn').disabled = true;
            document.getElementById('speechToTextBtn').disabled = true;
            document.getElementById('collectAnswerBtn').disabled = true;
            
            // Aktifkan tombol lanjut
            document.getElementById('nextQuestionBtn').disabled = false;
            
            updateDynamicIsland('✅ Jawaban berhasil dikumpulkan!', 2000);
        }

        // Fungsi untuk inisialisasi rekaman suara
        function initVoiceRecording() {
            const startBtn = document.getElementById('startRecordingBtn');
            const stopBtn = document.getElementById('stopRecordingBtn');
            const transcribeBtn = document.getElementById('transcribeBtn');
            
            startBtn.addEventListener('click', startVoiceRecording);
            stopBtn.addEventListener('click', stopVoiceRecording);
            transcribeBtn.addEventListener('click', transcribeRecording);
        }

        // Fungsi untuk inisialisasi speech recognition
        function initSpeechRecognition() {
            // Cek apakah browser mendukung Web Speech API
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                InterviewApp.voiceRecording.isSpeechRecognitionSupported = true;
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                InterviewApp.voiceRecording.recognition = new SpeechRecognition();
                
                // Konfigurasi
                InterviewApp.voiceRecording.recognition.continuous = false;
                InterviewApp.voiceRecording.recognition.interimResults = true;
                InterviewApp.voiceRecording.recognition.lang = 'id-ID';
                
                // Event handlers
                InterviewApp.voiceRecording.recognition.onstart = function() {
                    updateDynamicIsland('🎤 Mendengarkan...', 3000);
                    document.getElementById('voiceRecordingStatus').textContent = 'Mendengarkan...';
                };
                
                InterviewApp.voiceRecording.recognition.onresult = function(event) {
                    let interimTranscript = '';
                    let finalTranscript = '';
                    
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        if (event.results[i].isFinal) {
                            finalTranscript += event.results[i][0].transcript;
                        } else {
                            interimTranscript += event.results[i][0].transcript;
                        }
                    }
                    
                    const textarea = document.getElementById('answerInput');
                    if (finalTranscript) {
                        textarea.value = finalTranscript;
                        updateDynamicIsland('✅ Transkripsi selesai', 2000);
                    } else if (interimTranscript) {
                        textarea.value = interimTranscript;
                    }
                };
                
                InterviewApp.voiceRecording.recognition.onerror = function(event) {
                    console.error('Speech recognition error', event.error);
                    updateDynamicIsland('❌ Error speech recognition: ' + event.error, 3000);
                };
                
                InterviewApp.voiceRecording.recognition.onend = function() {
                    document.getElementById('voiceRecordingStatus').textContent = 'Speech-to-Text selesai';
                };
                
                // Tambahkan event listener untuk tombol speech-to-text
                document.getElementById('speechToTextBtn').addEventListener('click', function() {
                    if (InterviewApp.voiceRecording.recognition) {
                        InterviewApp.voiceRecording.recognition.start();
                    }
                });
            } else {
                // Browser tidak mendukung Web Speech API
                document.getElementById('speechToTextBtn').disabled = true;
                document.getElementById('speechToTextBtn').title = 'Browser tidak mendukung Speech Recognition';
                updateDynamicIsland('❌ Browser tidak mendukung Speech-to-Text', 3000);
            }
        }

        // Fungsi untuk memulai rekaman suara
        async function startVoiceRecording() {
            try {
                // Reset state rekaman sebelumnya
                InterviewApp.voiceRecording.audioChunks = [];
                InterviewApp.voiceRecording.audioBlob = null;
                InterviewApp.voiceRecording.audioUrl = null;
                InterviewApp.voiceRecording.transcription = "";
                InterviewApp.voiceRecording.transcriptionAccuracy = 0;
                
                // Dapatkan akses ke mikrofon
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                
                // Buat MediaRecorder
                InterviewApp.voiceRecording.mediaRecorder = new MediaRecorder(stream);
                
                // Event handler untuk data yang terekam
                InterviewApp.voiceRecording.mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        InterviewApp.voiceRecording.audioChunks.push(event.data);
                    }
                };
                
                // Event handler ketika rekaman berhenti
                InterviewApp.voiceRecording.mediaRecorder.onstop = () => {
                    // Buat blob dari chunks
                    InterviewApp.voiceRecording.audioBlob = new Blob(InterviewApp.voiceRecording.audioChunks, { type: 'audio/wav' });
                    InterviewApp.voiceRecording.audioUrl = URL.createObjectURL(InterviewApp.voiceRecording.audioBlob);
                    
                    // Update UI
                    document.getElementById('stopRecordingBtn').disabled = true;
                    document.getElementById('startRecordingBtn').disabled = false;
                    document.getElementById('transcribeBtn').disabled = false;
                    document.getElementById('voiceRecordingStatus').textContent = 'Rekaman selesai. Klik "Transkrip Otomatis" untuk mengubah suara menjadi teks.';
                    document.getElementById('voiceRecordingTimer').style.display = 'none';
                    document.getElementById('voiceRecordingVisualizer').style.display = 'none';
                    
                    // Hentikan semua track
                    stream.getTracks().forEach(track => track.stop());
                    
                    // Hentikan timer
                    clearInterval(InterviewApp.voiceRecording.recordingTimer);
                    InterviewApp.voiceRecording.recordingTimer = null;
                };
                
                // Mulai rekaman
                InterviewApp.voiceRecording.mediaRecorder.start();
                InterviewApp.voiceRecording.isRecording = true;
                
                // Update UI
                document.getElementById('startRecordingBtn').disabled = true;
                document.getElementById('stopRecordingBtn').disabled = false;
                document.getElementById('transcribeBtn').disabled = true;
                document.getElementById('voiceRecordingStatus').textContent = 'Sedang merekam...';
                document.getElementById('voiceRecordingTimer').style.display = 'block';
                document.getElementById('voiceRecordingVisualizer').style.display = 'block';
                
                // Mulai timer
                InterviewApp.voiceRecording.recordingStartTime = Date.now();
                InterviewApp.voiceRecording.recordingTimer = setInterval(updateRecordingTimer, 1000);
                
                // Animasi visualizer
                animateVoiceVisualizer();
                
                updateDynamicIsland('🎤 Rekaman suara dimulai', 2000);
            } catch (error) {
                console.error('Error accessing microphone:', error);
                updateDynamicIsland('❌ Gagal mengakses mikrofon', 2000);
                showCustomAlert('❌ Error', 'Tidak dapat mengakses mikrofon. Pastikan Anda memberikan izin akses mikrofon.');
            }
        }

        // Fungsi untuk menghentikan rekaman suara
        function stopVoiceRecording() {
            if (InterviewApp.voiceRecording.mediaRecorder && InterviewApp.voiceRecording.isRecording) {
                InterviewApp.voiceRecording.mediaRecorder.stop();
                InterviewApp.voiceRecording.isRecording = false;
                
                updateDynamicIsland('⏹️ Rekaman suara dihentikan', 2000);
            }
        }

        // Fungsi untuk memperbarui timer rekaman
        function updateRecordingTimer() {
            if (InterviewApp.voiceRecording.isRecording) {
                const currentTime = Date.now();
                InterviewApp.voiceRecording.recordingDuration = Math.floor((currentTime - InterviewApp.voiceRecording.recordingStartTime) / 1000);
                
                const minutes = Math.floor(InterviewApp.voiceRecording.recordingDuration / 60);
                const seconds = InterviewApp.voiceRecording.recordingDuration % 60;
                
                document.getElementById('voiceRecordingTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Fungsi untuk animasi visualizer suara
        function animateVoiceVisualizer() {
            const visualizer = document.getElementById('voiceRecordingWave');
            if (!visualizer || !InterviewApp.voiceRecording.isRecording) return;
            
            // Simulasi gelombang suara
            const height = 20 + Math.random() * 40;
            visualizer.style.height = `${height}%`;
            
            if (InterviewApp.voiceRecording.isRecording) {
                requestAnimationFrame(animateVoiceVisualizer);
            }
        }

        // Fungsi untuk mentranskrip rekaman suara
        function transcribeRecording() {
            if (!InterviewApp.voiceRecording.audioBlob) {
                updateDynamicIsland('❌ Tidak ada rekaman untuk ditranskrip', 2000);
                return;
            }
            
            updateDynamicIsland('🔊 Memproses transkripsi...', 3000);
            
            // Simulasi transkripsi dengan akurasi tinggi
            // Dalam implementasi nyata, ini akan terhubung ke API speech-to-text
            setTimeout(() => {
                // Simulasi hasil transkripsi dengan akurasi tinggi
                const simulatedTranscription = simulateTranscription();
                InterviewApp.voiceRecording.transcription = simulatedTranscription.text;
                InterviewApp.voiceRecording.transcriptionAccuracy = simulatedTranscription.accuracy;
                
                // Tampilkan hasil transkripsi
                document.getElementById('transcriptionText').textContent = InterviewApp.voiceRecording.transcription;
                document.getElementById('transcriptionAccuracy').textContent = 
                    `Akurasi: ${InterviewApp.voiceRecording.transcriptionAccuracy}%`;
                document.getElementById('transcriptionResult').style.display = 'block';
                
                // Salin hasil transkripsi ke textarea jawaban
                document.getElementById('answerInput').value = InterviewApp.voiceRecording.transcription;
                
                updateDynamicIsland('✅ Transkripsi selesai!', 3000);
            }, 2000);
        }

        // Fungsi untuk mensimulasikan transkripsi dengan akurasi tinggi
        function simulateTranscription() {
            const currentQuestion = interviewQuestions[InterviewApp.currentSubject][InterviewApp.currentQuestionIndex];
            let transcription = "";
            let accuracy = 95 + Math.floor(Math.random() * 5); // Akurasi 95-100%
            
            // Simulasikan jawaban berdasarkan pertanyaan
            if (currentQuestion.includes("nama")) {
                transcription = "Nama saya Muhammad Najib Wahidus Salam";
            } else if (currentQuestion.includes("kelas")) {
                transcription = "Saya kelas 4 di SD Negeri Quantum Indonesia";
            } else if (currentQuestion.includes("mata pelajaran")) {
                transcription = "Mata pelajaran favorit saya adalah Matematika karena saya senang berhitung dan memecahkan masalah";
            } else if (currentQuestion.includes("hobi")) {
                transcription = "Hobi saya adalah bermain sepak bola dan membaca buku cerita";
            } else if (currentQuestion.includes("teman")) {
                transcription = "Teman terdekat saya adalah Ahmad, dia sangat baik dan pintar dalam pelajaran";
            } else if (currentQuestion.includes("cita-cita")) {
                transcription = "Cita-cita saya adalah menjadi seorang guru seperti Pak Najib";
            } else if (currentQuestion.includes("perasaan tentang sekolah")) {
                transcription = "Saya sangat senang bersekolah karena bisa belajar dan bermain dengan teman-teman";
            } else if (currentQuestion.includes("kegiatan sekolah")) {
                transcription = "Kegiatan sekolah yang paling menyenangkan adalah pelajaran olahraga dan ekstrakurikuler";
            } else if (currentQuestion.includes("mengubah")) {
                transcription = "Jika bisa mengubah satu hal, saya ingin ada lebih banyak buku di perpustakaan sekolah";
            } else if (currentQuestion.includes("pelajaran menantang")) {
                transcription = "Pelajaran yang paling menantang adalah IPA, tetapi saya berusaha memahami dengan bertanya kepada guru";
            } else {
                // Jawaban generik untuk pertanyaan lainnya
                transcription = "Saya akan menjawab pertanyaan ini dengan sebaik-baiknya berdasarkan pengetahuan dan pengalaman saya. " +
                               "Saya berusaha memberikan jawaban yang tepat dan bermanfaat untuk proses wawancara ini.";
            }
            
            return {
                text: transcription,
                accuracy: accuracy
            };
        }

        // Fungsi untuk membatalkan wawancara
        function cancelInterview() {
            if (confirm('Apakah Anda yakin ingin membatalkan wawancara? Semua jawaban akan hilang.')) {
                // Hentikan rekaman jika sedang berlangsung
                if (InterviewApp.voiceRecording.isRecording) {
                    stopVoiceRecording();
                }
                
                // Hentikan speech recognition jika sedang berjalan
                if (InterviewApp.voiceRecording.recognition) {
                    InterviewApp.voiceRecording.recognition.stop();
                }
                
                const modal = document.getElementById('interviewModal');
                modal.classList.remove('active');
                updateDynamicIsland('❌ Wawancara Dibatalkan', 2000);
            }
        }

        // Fungsi untuk pindah ke pertanyaan sebelumnya
        function prevQuestion() {
            if (InterviewApp.currentQuestionIndex > 0) {
                // Simpan jawaban saat ini
                saveCurrentAnswer();
                
                InterviewApp.currentQuestionIndex--;
                updateQuestionDisplay();
                updateProgressBar();
                
                // Update tombol navigasi
                document.getElementById('prevQuestionBtn').disabled = InterviewApp.currentQuestionIndex === 0;
                document.getElementById('nextQuestionBtn').innerHTML = InterviewApp.currentQuestionIndex === interviewQuestions[InterviewApp.currentSubject].length - 1 ? 
                    '<i class="fas fa-flag-checkered"></i> Selesai' : 
                    '<i class="fas fa-arrow-right"></i> Lanjut';
                    
                // Periksa apakah jawaban sudah dikumpulkan untuk pertanyaan ini
                checkIfAnswerCollected();
            }
        }

        // Fungsi untuk pindah ke pertanyaan berikutnya
        function nextQuestion() {
            // Simpan jawaban saat ini
            saveCurrentAnswer();
            
            if (InterviewApp.currentQuestionIndex < interviewQuestions[InterviewApp.currentSubject].length - 1) {
                InterviewApp.currentQuestionIndex++;
                updateQuestionDisplay();
                updateProgressBar();
                
                // Update tombol navigasi
                document.getElementById('prevQuestionBtn').disabled = InterviewApp.currentQuestionIndex === 0;
                document.getElementById('nextQuestionBtn').innerHTML = InterviewApp.currentQuestionIndex === interviewQuestions[InterviewApp.currentSubject].length - 1 ? 
                    '<i class="fas fa-flag-checkered"></i> Selesai' : 
                    '<i class="fas fa-arrow-right"></i> Lanjut';
                    
                // Periksa apakah jawaban sudah dikumpulkan untuk pertanyaan ini
                checkIfAnswerCollected();
            } else {
                // Selesai wawancara
                finishInterview();
            }
        }

        // Fungsi untuk memeriksa apakah jawaban sudah dikumpulkan
        function checkIfAnswerCollected() {
            const answerInput = document.getElementById('answerInput');
            const startBtn = document.getElementById('startRecordingBtn');
            const stopBtn = document.getElementById('stopRecordingBtn');
            const transcribeBtn = document.getElementById('transcribeBtn');
            const speechToTextBtn = document.getElementById('speechToTextBtn');
            const collectBtn = document.getElementById('collectAnswerBtn');
            const nextBtn = document.getElementById('nextQuestionBtn');
            
            if (InterviewApp.collectedAnswers[InterviewApp.currentQuestionIndex]) {
                // Jawaban sudah dikumpulkan
                answerInput.disabled = true;
                startBtn.disabled = true;
                stopBtn.disabled = true;
                transcribeBtn.disabled = true;
                speechToTextBtn.disabled = true;
                collectBtn.disabled = true;
                nextBtn.disabled = false;
                
                // Isi jawaban yang sudah dikumpulkan
                answerInput.value = InterviewApp.collectedAnswers[InterviewApp.currentQuestionIndex];
            } else {
                // Jawaban belum dikumpulkan
                answerInput.disabled = false;
                startBtn.disabled = false;
                stopBtn.disabled = true;
                transcribeBtn.disabled = true;
                speechToTextBtn.disabled = !InterviewApp.voiceRecording.isSpeechRecognitionSupported;
                collectBtn.disabled = false;
                nextBtn.disabled = true;
                
                // Isi jawaban sementara jika ada
                answerInput.value = InterviewApp.answers[InterviewApp.currentQuestionIndex] || '';
            }
        }

        // Fungsi untuk menyimpan jawaban saat ini
        function saveCurrentAnswer() {
            const answerInput = document.getElementById('answerInput');
            InterviewApp.answers[InterviewApp.currentQuestionIndex] = answerInput.value;
        }

        // Fungsi untuk memperbarui tampilan pertanyaan
        function updateQuestionDisplay() {
            document.getElementById('currentQuestionText').textContent = 
                interviewQuestions[InterviewApp.currentSubject][InterviewApp.currentQuestionIndex];
            
            document.getElementById('currentQuestion').textContent = InterviewApp.currentQuestionIndex + 1;
            
            // Reset state rekaman untuk pertanyaan baru
            resetVoiceRecordingState();
        }

        // Fungsi untuk mereset state rekaman suara
        function resetVoiceRecordingState() {
            // Hentikan rekaman jika sedang berlangsung
            if (InterviewApp.voiceRecording.isRecording) {
                stopVoiceRecording();
            }
            
            // Hentikan speech recognition jika sedang berjalan
            if (InterviewApp.voiceRecording.recognition) {
                InterviewApp.voiceRecording.recognition.stop();
            }
            
            // Reset UI
            document.getElementById('startRecordingBtn').disabled = false;
            document.getElementById('stopRecordingBtn').disabled = true;
            document.getElementById('transcribeBtn').disabled = true;
            document.getElementById('voiceRecordingStatus').textContent = 'Tekan tombol rekam untuk mulai merekam jawaban';
            document.getElementById('voiceRecordingTimer').style.display = 'none';
            document.getElementById('voiceRecordingVisualizer').style.display = 'none';
            document.getElementById('transcriptionResult').style.display = 'none';
            
            // Reset data
            InterviewApp.voiceRecording.audioChunks = [];
            InterviewApp.voiceRecording.audioBlob = null;
            InterviewApp.voiceRecording.audioUrl = null;
            InterviewApp.voiceRecording.transcription = "";
            InterviewApp.voiceRecording.transcriptionAccuracy = 0;
            InterviewApp.voiceRecording.recordingDuration = 0;
        }

        // Fungsi untuk memperbarui progress bar
        function updateProgressBar() {
            const progress = (InterviewApp.currentQuestionIndex / (interviewQuestions[InterviewApp.currentSubject].length - 1)) * 100;
            document.getElementById('interviewProgress').style.width = `${progress}%`;
        }

        // Fungsi untuk memulai timer wawancara
        function startInterviewTimer() {
            const startTime = Date.now();
            const timerElement = document.getElementById('interviewTime');
            
            InterviewApp.timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                timerElement.textContent = `Waktu: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // Fungsi untuk menyelesaikan wawancara
        function finishInterview() {
            clearInterval(InterviewApp.timerInterval);
            
            // Simpan jawaban terakhir
            saveCurrentAnswer();
            
            // Hentikan rekaman jika sedang berlangsung
            if (InterviewApp.voiceRecording.isRecording) {
                stopVoiceRecording();
            }
            
            // Hentikan speech recognition jika sedang berjalan
            if (InterviewApp.voiceRecording.recognition) {
                InterviewApp.voiceRecording.recognition.stop();
            }
            
            // Tutup modal wawancara
            const interviewModal = document.getElementById('interviewModal');
            interviewModal.classList.remove('active');
            
            // Tampilkan hasil
            showInterviewResults();
            
            // Update statistik
            InterviewApp.stats.interviewsCompleted++;
            InterviewApp.stats.totalQuestions += interviewQuestions[InterviewApp.currentSubject].length;
            
            updateDynamicIsland('✅ Wawancara Selesai', 2000);
        }

        // Fungsi untuk menampilkan hasil wawancara
        function showInterviewResults() {
            const modal = document.getElementById('resultsModal');
            const content = document.getElementById('resultsContent');
            
            // Set judul berdasarkan subjek
            let subjectTitle = '';
            switch(InterviewApp.currentSubject) {
                case 'siswa':
                    subjectTitle = 'Siswa Kelas 4';
                    break;
                case 'guru':
                    subjectTitle = 'Guru Kelas 4';
                    break;
                case 'kepala_sekolah':
                    subjectTitle = 'Kepala Sekolah';
                    break;
                case 'staf_tu':
                    subjectTitle = 'Staf Tata Usaha';
                    break;
                case 'petugas_kantin':
                    subjectTitle = 'Petugas Kantin';
                    break;
            }
            
            const answeredCount = InterviewApp.collectedAnswers.filter(a => a && a.trim() !== '').length;
            const completionRate = Math.round((answeredCount / interviewQuestions[InterviewApp.currentSubject].length) * 100);
            
            content.innerHTML = `
                <div class="results-title">Hasil Wawancara</div>
                <p class="subtitle">Subjek: ${subjectTitle}</p>
                
                <div class="results-summary">
                    <div class="stat-card">
                        <div class="stat-value">${interviewQuestions[InterviewApp.currentSubject].length}</div>
                        <div class="stat-label">Total Pertanyaan</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${answeredCount}</div>
                        <div class="stat-label">Pertanyaan Terjawab</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${completionRate}%</div>
                        <div class="stat-label">Tingkat Penyelesaian</div>
                    </div>
                </div>
                
                <div class="answers-review">
                    <h3 style="margin-bottom: 15px; text-align: center;">Ringkasan Jawaban</h3>
                    ${interviewQuestions[InterviewApp.currentSubject].map((question, index) => `
                        <div class="answer-item">
                            <div class="answer-question">${index + 1}. ${question}</div>
                            <div>${InterviewApp.collectedAnswers[index] || '<em style="color: #999;">Tidak dijawab</em>'}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="children-report" id="childrenReport">
                    <div class="sticker sticker-1">🎤</div>
                    <div class="sticker sticker-2">🌟</div>
                    <div class="sticker sticker-3">📚</div>
                    <div class="sticker sticker-4">🎨</div>
                    
                    <div class="children-header">
                        <h1 class="children-title">HASIL WAWANCARA KU</h1>
                        <p class="children-subtitle">Aku Hebat Berbicara dan Bercerita!</p>
                    </div>
                    
                    <div class="animal-characters">
                        <div class="animal">🐯</div>
                        <div class="animal">🐘</div>
                        <div class="animal">🦁</div>
                        <div class="animal">🐼</div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
                        <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 20px; text-align: center; border: 3px dashed #ff6b6b;">
                            <div style="font-size: 2rem; font-weight: bold; color: #667eea; margin-bottom: 5px;">${interviewQuestions[InterviewApp.currentSubject].length}</div>
                            <div style="font-size: 0.9rem; color: #666;">Total Pertanyaan</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 20px; text-align: center; border: 3px dashed #ff6b6b;">
                            <div style="font-size: 2rem; font-weight: bold; color: #667eea; margin-bottom: 5px;">${answeredCount}</div>
                            <div style="font-size: 0.9rem; color: #666;">Pertanyaan Terjawab</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 20px; text-align: center; border: 3px dashed #ff6b6b;">
                            <div style="font-size: 2rem; font-weight: bold; color: #667eea; margin-bottom: 5px;">${completionRate}%</div>
                            <div style="font-size: 0.9rem; color: #666;">Tingkat Penyelesaian</div>
                        </div>
                    </div>
                    
                    <div style="background: #fff9c4; padding: 20px; border-radius: 20px; margin-bottom: 25px; border: 3px solid #ffd93d;">
                        <h3 style="font-size: 1.5rem; color: #ff6b6b; text-align: center; margin-bottom: 15px; font-weight: bold;">🎖️ PENCAPAIAN HEBATKU</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                            <div style="background: white; padding: 15px; border-radius: 15px; text-align: center; border: 2px solid #a8edea;">
                                <div style="font-size: 2rem;">🎤</div>
                                <div>Berani Berbicara</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 15px; text-align: center; border: 2px solid #a8edea;">
                                <div style="font-size: 2rem;">💬</div>
                                <div>Jawaban Panjang</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 15px; text-align: center; border: 2px solid #a8edea;">
                                <div style="font-size: 2rem;">🎯</div>
                                <div>Akurasi Tinggi</div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 15px; text-align: center; border: 2px solid #a8edea;">
                                <div style="font-size: 2rem;">⭐</div>
                                <div>Semangat Belajar</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #e3f2fd; padding: 25px; border-radius: 20px; margin-bottom: 25px; border: 3px solid #4d96ff;">
                        <h3 style="font-size: 1.5rem; color: #4d96ff; text-align: center; margin-bottom: 20px; font-weight: bold;">📝 JAWABAN-JAWABAN HEBATKU</h3>
                        ${interviewQuestions[InterviewApp.currentSubject].slice(0, 3).map((question, index) => `
                            <div style="background: white; padding: 15px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid #ff6b6b;">
                                <div style="font-weight: bold; color: #667eea; margin-bottom: 8px;">${index + 1}. ${question}</div>
                                <div>${InterviewApp.collectedAnswers[index] || '<em style="color: #999;">Aku akan menjawab dengan baik!</em>'}</div>
                            </div>
                        `).join('')}
                        ${interviewQuestions[InterviewApp.currentSubject].length > 3 ? 
                            `<div style="text-align: center; margin-top: 15px; font-style: italic; color: #666;">
                                ... dan ${interviewQuestions[InterviewApp.currentSubject].length - 3} pertanyaan hebat lainnya!
                            </div>` : ''}
                    </div>
                    
                    <div class="certificate">
                        <h2 class="certificate-title">SERTIFIKAT HEBAT</h2>
                        <p style="font-size: 1.2rem; color: #666; margin-bottom: 20px;">
                            Diberikan kepada <strong>ANAK HEBAT</strong> atas keberanian dan 
                            keaktifan dalam wawancara interaktif!
                        </p>
                        <div style="font-size: 4rem; margin: 20px 0;">🏆</div>
                        <p style="font-size: 1.1rem; color: #666;">
                            "Teruslah berbicara dan berbagi cerita, karena suaramu sangat berharga!"
                        </p>
                        
                        <div style="margin-top: 30px; border-top: 2px dashed #ff6b6b; padding-top: 15px;">
                            <div style="margin-bottom: 10px;">Disetujui oleh:</div>
                            <div style="font-weight: bold; font-size: 1.2rem; color: #ff6b6b;">
                                Guru Terbaikku
                            </div>
                            <div style="margin-top: 20px; font-size: 0.9rem; color: #666;">
                                Aplikasi Wawancara Interaktif Kelas 4<br>
                                ${new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 0.9rem;">
                        <p>✨ Aku bangga dengan hasil kerjaku! ✨</p>
                        <p>Terima kasih sudah mendengarkan ceritaku!</p>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px; flex-wrap: wrap;">
                    <button class="btn btn-danger" id="closeResultsBtn">
                        <i class="fas fa-times"></i> Tutup
                    </button>
                    <button class="btn btn-success" id="exportPdfBtn">
                        <i class="fas fa-file-pdf"></i> Ekspor ke PDF
                    </button>
                    <button class="btn btn-info" id="exportPngBtn">
                        <i class="fas fa-image"></i> Ekspor ke PNG
                    </button>
                    <button class="btn btn-warning" id="printReportBtn">
                        <i class="fas fa-print"></i> Print Laporan
                    </button>
                </div>
            `;
            
            modal.classList.add('active');
            
            // Event listeners
            document.getElementById('closeResultsBtn').addEventListener('click', () => {
                modal.classList.remove('active');
            });
            
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPdf);
            document.getElementById('exportPngBtn').addEventListener('click', exportToPng);
            document.getElementById('printReportBtn').addEventListener('click', printReport);
        }

        // Fungsi untuk mengekspor ke PDF
        async function exportToPdf() {
            updateDynamicIsland('📄 Membuat PDF...', 3000);
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Ambil elemen konten laporan anak
                const element = document.getElementById('childrenReport');
                
                // Gunakan html2canvas untuk menangkap konten sebagai gambar
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    logging: false
                });
                
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Tambahkan halaman tambahan jika diperlukan
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Simpan PDF
                pdf.save(`Wawancara-${InterviewApp.currentSubject}-${Date.now()}.pdf`);
                
                updateDynamicIsland('✅ PDF Berhasil Diekspor', 2000);
            } catch (error) {
                console.error('Error generating PDF:', error);
                updateDynamicIsland('❌ Gagal Mengekspor PDF', 2000);
            }
        }

        // Fungsi untuk mengekspor ke PNG
        async function exportToPng() {
            updateDynamicIsland('🖼️ Membuat PNG...', 3000);
            
            try {
                // Ambil elemen konten laporan anak
                const element = document.getElementById('childrenReport');
                
                // Gunakan html2canvas untuk menangkap konten sebagai gambar
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    logging: false
                });
                
                // Convert ke image dan download
                const image = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = image;
                link.download = `hasil-wawancara-anak-${Date.now()}.png`;
                link.click();
                
                updateDynamicIsland('✅ PNG Berhasil Diekspor', 2000);
            } catch (error) {
                console.error('Error generating PNG:', error);
                updateDynamicIsland('❌ Gagal Mengekspor PNG', 2000);
            }
        }

        // Fungsi untuk mencetak laporan
        function printReport() {
            updateDynamicIsland('🖨️ Mempersiapkan cetakan...', 2000);
            
            // Buat jendela baru untuk mencetak
            const printWindow = window.open('', '_blank');
            const reportContent = document.getElementById('childrenReport').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Laporan Wawancara</title>
                    <style>
                        body { 
                            font-family: 'Comic Sans MS', cursive; 
                            margin: 20px;
                            background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%);
                        }
                        .sticker {
                            position: absolute;
                            width: 80px;
                            height: 80px;
                            background: #ffd93d;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 2rem;
                            transform: rotate(-15deg);
                            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                            border: 3px solid #ff6b6b;
                        }
                        .sticker-1 { top: -20px; left: -20px; }
                        .sticker-2 { top: -20px; right: -20px; background: #6bcf7f; }
                        .sticker-3 { bottom: -20px; left: -20px; background: #4d96ff; }
                        .sticker-4 { bottom: -20px; right: -20px; background: #ff6b9d; }
                        @media print {
                            body { 
                                background: white !important;
                                -webkit-print-color-adjust: exact;
                            }
                        }
                    </style>
                </head>
                <body>
                    ${reportContent}
                    <script>
                        window.onload = function() {
                            window.print();
                            setTimeout(() => window.close(), 1000);
                        };
                    <\/script>
                </body>
                </html>
            `);
            printWindow.document.close();
        }

        // Fungsi untuk menampilkan alert kustom
        function showCustomAlert(title, message) {
            const alertDiv = document.createElement('div');
            alertDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 25px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                z-index: 3000;
                text-align: center;
                max-width: 400px;
                width: 90%;
            `;
            
            alertDiv.innerHTML = `
                <h3 style="margin-bottom: 15px; color: var(--text-primary);">${title}</h3>
                <p style="margin-bottom: 20px; color: var(--text-secondary);">${message}</p>
                <button class="btn btn-primary" id="closeAlertBtn" style="margin: 0 auto;">
                    <i class="fas fa-check"></i> Oke
                </button>
            `;
            
            document.body.appendChild(alertDiv);
            
            document.getElementById('closeAlertBtn').addEventListener('click', () => {
                document.body.removeChild(alertDiv);
            });
        }

        // Fungsi untuk menampilkan informasi developer
        function showDeveloperInfo() {
            const modal = document.getElementById('developerModal');
            const content = document.getElementById('developerContent');

            updateDynamicIsland('👨‍🏫 Developer Quantum Info', 3000);

            content.innerHTML = `
                <div class="interview-header">
                    <h2 class="interview-title">Developer Information</h2>
                    <p class="interview-subject">Muhammad Najib Wahidus Salam, S.Pd, Gr.</p>
                </div>
                
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="width: 150px; height: 150px; margin: 0 auto 20px; border-radius: 50%; background: var(--primary); display: flex; align-items: center; justify-content: center; color: white; font-size: 3rem;">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <h3 style="font-size: 1.8rem; color: var(--text-primary); margin-bottom: 10px;">
                        Muhammad Najib Wahidus Salam, S.Pd, Gr.
                    </h3>
                    <p style="font-size: 1.2rem; color: var(--primary); margin-bottom: 15px;">
                        Quantum Mathematics Educator & AI Architect
                    </p>
                    <div style="font-size: 1rem; font-weight: 700; color: var(--text-primary);">
                        🚀 Creator of NAJIB AI BRAIN Quantum QR Scanner Mathematics v6.0
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 20px; border-radius: 20px; border: 2px solid var(--primary);">
                        <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.2rem;">
                            📋 Personal Data
                        </h4>
                        <div style="color: var(--text-primary); font-weight: 600; line-height: 1.8; font-size: 14px;">
                            <div><strong>🏠 Born:</strong> Sidoarjo, September 27, 1996</div>
                            <div><strong>🎓 Education:</strong> S1-PGSD (2014-2021)</div>
                            <div><strong>📜 Certification:</strong> PPG Prajabatan 2024 Wave 1</div>
                            <div><strong>👨‍🏫 Profession:</strong> Non-ASN Teacher & AI Architect</div>
                            <div><strong>🎨 Expertise:</strong> Quantum QR Educational Technology</div>
                            <div><strong>💡 Innovation:</strong> Interactive QR Scanner Learning</div>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, rgba(17, 153, 142, 0.1), rgba(56, 239, 125, 0.1)); padding: 20px; border-radius: 20px; border: 2px solid var(--success);">
                        <h4 style="color: var(--success); margin-bottom: 15px; font-size: 1.2rem;">
                            🏆 Patent Status v6.0
                        </h4>
                        <div style="text-align: center;">
                            <div style="font-weight: 700; font-size: 1.2rem; margin-bottom: 10px; color: var(--text-primary);">
                                QUANTUM QR SCANNER MATHEMATICS v6.0
                            </div>
                            <div style="font-weight: 600; margin-bottom: 10px; color: var(--primary); font-size: 13px;">
                                PAT-NAJIB-AI-BRAIN-QR-MATH-v6.0-2025
                            </div>
                            <div style="color: var(--success); font-weight: 700; margin-bottom: 8px; font-size: 13px;">Protected by International Patent Law v6.0</div>
                            <div style="color: var(--warning); font-weight: 700; font-size: 13px;">First QR-based Mathematics Learning System</div>
                        </div>
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 20px; border-radius: 20px; border: 2px solid var(--primary); margin-bottom: 20px;">
                    <h4 style="color: var(--primary); margin-bottom: 15px; font-size: 1.3rem; text-align: center;">
                        🚀 Wawancara Interaktif Kelas 4 dengan Rekaman Suara
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; font-size: 13px; font-weight: 600; color: var(--text-primary);">
                        <div>✅ 5 Subjek Wawancara Berbeda</div>
                        <div>✅ 10 Pertanyaan per Subjek</div>
                        <div>✅ <strong>Rekaman Suara Terintegrasi</strong></div>
                        <div>✅ <strong>Transkripsi Otomatis dengan Akurasi Tinggi</strong></div>
                        <div>✅ Visualizer Suara Real-time</div>
                        <div>✅ Timer Rekaman</div>
                        <div>✅ Sistem Navigasi Pertanyaan</div>
                        <div>✅ Progress Bar Visual</div>
                        <div>✅ Timer Wawancara</div>
                        <div>✅ Statistik Penyelesaian</div>
                        <div>✅ Ringkasan Jawaban</div>
                        <div>✅ Laporan Anak-anak</div>
                        <div>✅ Ekspor ke Format PDF & PNG</div>
                        <div>✅ Fitur Print Langsung</div>
                        <div>✅ UI Dinamis dengan Gradien</div>
                        <div>✅ Responsif untuk Mobile & Desktop</div>
                        <div>✅ Tanpa Ketergantungan API Eksternal</div>
                        <div>✅ Independent & Self-contained</div>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-success" id="closeDeveloperModal">
                        <i class="fas fa-heart"></i> Tutup
                    </button>
                </div>
            `;

            modal.classList.add('active');

            // Add event listeners
            document.getElementById('closeDeveloperModal').addEventListener('click', () => {
                modal.classList.remove('active');
            });
        }

        // Inisialisasi aplikasi
        document.addEventListener('DOMContentLoaded', function() {
            updateDynamicIsland('🚀 Aplikasi Wawancara dengan Rekaman Suara Siap!', 3000);
        });
    </script>
</body>
</html>
